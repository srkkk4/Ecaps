## 巴什博弈

最经典的入门博弈游戏, 本文将有所拔高, 为 $\text{SG}$ 函数作铺垫

#### $\S $ 巴什博弈

> 一堆 $n$ 个石子, $A$ 与 $B$ 依次轮流操作, 每个人每次最少取 $1$ 个, 最多取 $m$ 个, 无法操作者输, 问是否有先手必胜策略

一般而言, 博弈论要反着推, 我们设状态 $f(n)$ 表示还剩 $n$ 个石子的时候是否有先手必胜策略, $1$ 为是, $0$ 为否

这里先要证明一个命题 : 对于一个状态, 如果不存在先手必胜策略, 必然存在后手必胜策略

为了解决这个, 我们先了解一点 $\text{SG}$ 函数的思想, 我们知道, 这个游戏是可以在有限次数内完成的, 因为每次至少减 $1$, 那么, 我们可以枚举出所有情况, 画出一个类似于搜索树的东西, 也就是是决策树 ( 实际上是 $\text{DAG}$, 这个决策树是我习惯的表述方式 )

其中点代表了状态, 在该博弈中, 就是还剩多少石子, 边代表了决策, 用动态规划的讲法就是状态转移, 在巴什博弈中意味着某一次取多少石子

为了方便, 我习惯性地将决策树中入度为 $0$ 的点称作根, 出度为 $0$ 的点叫做叶子, 很显然, 叶子节点代表了最终状态, 也就是只剩下 $0$ 个石子, 这个情况显然是先手必败, $f(0) = 0$

我们来反推

先思考一下什么情况下先手必败, 比如说我们现在判断在有 $n$ 个石子的情况下如何

若 $\forall i\in [1, m], f(n - i) = 1\ (i\leqslant n)$, 那么先手必败, 因为我现在无论怎么操作, 都会把对手引向一个先手必胜的状态, 那对手获胜就意味着我败了

再思考一下什么情况下能先手必胜, 比如说我们现在求解 $f(n)$

答案很显然, 如果 $\exists i \in [1, m], f(n - i) = 0\ (i\leqslant n)$ , 那么 $f(n) = 1$

不难发现, 先手必败与先手必胜的充要条件是互斥的, 那么对于任意一个状态非黑即白, 要么先手必胜, 要么先手必败

不难发现, 博弈与动态规划十分相像, 事实上, 这个问题的确可以通过 $O(n)$ 的单调队列优化$\text{DP}$ 来解决

但我们可以继续数学推导得到, $f(n) = [(m + 1)\mid n] \oplus 1$, 这个把表列出来还是很容易发现的, 至于严谨证明可用归纳法

如果每次只能取 $x\in [l, r]$ 个石子呢 ?

我们容易发现, 先手必胜与先手必败是交替的, 具体而言, 我们尝试这样得出答案

首先确定终止状态 $[0, l)$ 为必败区间, 考虑后面, 我们作为先手, 希望能最大限度地跳到必败状态, 那么, 最好是跳 $r$ 个, 那么 $[l, l + r)$  为必胜区间, 然后, 我们虽然知道后面有一段是必败情况, 那么我们希望使必败情况短一点, 那么 $[l + r, 2l + r)$ 为必败区间, 然后反复 $...$

这是从自然的角度出发逆推, 还需理性证明, 依然可以用归纳法

虽然貌似废话一堆, 但实际上 $\text{SG}$ 函数的大致思想就讲完了, 就相当于结合例子把