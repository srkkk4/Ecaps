## 斐波那契博弈

这是一个 ~~休闲~~ 的博弈论游戏, 其证明十分 ~~休闲~~

#### $\S $ 斐波那契博弈

> 有一堆石子个数为 $n\ (n\geqslant 2)$ 的石子, $A$ 与 $B$ 轮流取石子, 不能行动者输, 规则如下 : 
>
> 1. 每次取石子的个数至少为 $1$, 至多为对手上一次取石子数的 $2$ 倍
> 2. 先手第一次能取任意个石子 ( 显然不能为 $0$ ), 但不能将石子取光
>
> 问先手是否有必胜策略 ? 

有一种手段, 对于博弈论都是先算小的情况, 然后推出规律, 然后证明 ( 不要觉得这样不科学 )

由于这个叫斐波那契博弈, 所以 **当** $n$ **为斐波那契数的时候, 先手必败** ( 雾

我们归纳证明一下, 记 $f(n)$ 表示 有 $n$ 个石子的时候是先手必胜还是先手必败, 先手必败为 $0$, 先手必胜为 $1$, 同时记 $\text{Fib}_i$ 表示第 $i$ 个斐波那契数, $\text{Fib}_0 = \text{Fib}_1 = 1$

显然, $f(2) = 0$

不妨先考虑 $n$ 为第 $k$ 个斐波那契数, 即 $n = \text{Fib}_k$, 假设对于 $2$ ~ $k - 1$ 的 $n = \text{Fib}_i$ 都成立

对于这堆石子, 我们可以将其看做两堆, 一堆大小为 $\text{Fib}_{k - 2}$, 另一堆为 $\text{Fib}_{k - 1}$, 因为 $\text{Fib}_{k - 2} + \text{Fib}_{k - 1} = \text{Fib}_k$

我们不妨让先手先取 $\text{Fib}_{k - 2}$ 这一堆, 显然, 先手不能一次性将这一堆取完, 因为恒有 $\text{Fib}_{k - 1} \leqslant 2\cdot \text{Fib}_{k - 2}$, 取超过 $\text{Fib}_{k - 2}$ 的显然也是不行的

由于我们之前假设的结论, 显然, 后手总是有办法将这一堆的最后一个石子取到手, 那么先手仍然会成为取 $\text{Fib}_{k - 1}$ 这一堆石子的先手

假设后手取完第一堆石子的最后一步取了 $x$ 个石子, 再由于之前的假设, 要让先手必败, 那么有 $x < \frac{\text{Fib}_{k - 1}}{2}$

所以我们只要证明上面那个不等式恒成立即可



假设先手第一次取了 $a$ 个石子

1. $a > \frac{\text{Fib}_{k - 2}}{3}$, 那么后手可以直接取完, $x = \text{Fib}_{k - 2} - a < \frac{2\cdot \text{Fib}_{k - 2}}{3}$

   要比较 $\frac{2\cdot \text{Fib}_{k - 2}}{3}$ 与 $\frac{\text{Fib}_{k - 1}}{2}$ 的大小, 实际上就是比较 $4\cdot \text{Fib}_{k - 2}$ 与 $3\cdot \text{Fib}_{k - 1}$ 的大小

   作差, 会有
   $$
   4\cdot \text{Fib}_{k - 2} - 3\cdot \text{Fib}_{k - 1} = \text{Fib}_{k - 2} - 3\cdot \text{Fib}_{k - 3} < 0
   $$
   所以得到这种情况先手必败

2. $a \leqslant \frac{\text{Fib}_{k - 2}}{3}$, 由于之前的假设, 后者在 $\text{Fib}_{k - 2}$ 中有必胜策略, 然而现在的情形意味着后手肯定不能在这一次取完, 那么按照最优策略行动, 必然存在某一时刻, 先手与后手总共取掉的石子个数必然大于 $\frac{\text{Fib}_{k - 2}}{3}$, 而且这次没有将 $\text{Fib}_{k - 2}$ 整个取完 ( 因为这之前的所有行动都会在 $[1, \frac{\text{Fib}_{k - 2}}{3}]$ 中 ), 并且在之后的操作过程中, 所有的操作都 小于等于 $\frac{2\cdot \text{Fib}_{k - 2}}{3}$, 自然也就小于 $\frac{\text{Fib}_{k - 1}}{2}$

   再由于之前的假设, 按照最优策略还是后手最后取完这堆 $\text{Fib}_{k - 2} $ 的石子



综上 **当** $n$ **为斐波那契数的时候, 先手必败**

那么, 若 $n$ 不为斐波那契数的时候是否先手必胜 ?



我们先考虑一个引理 

> $\text{Zeckendorf}$  **定理 / 齐肯多夫定理**
>
> 任何正整数可以表示为若干个不连续的 $\text{Fibonacci}$ 数之和
>
> 即 $n = \text{Fib}_{k_1} + \text{Fib}_{k_2} + ... \text{Fib}_{k_m}$
>
> 其中 $\forall i \in[1, m)$, $k_i < k_{i + 1} - 1$

一个很 ~~蠢~~ 显然的事实, $n = \sum_{i = 1}^n 1$ , 而 $\text{Fib}_0 = \text{Fib}_1 = 1$

我们想象动态维护一个集合 $S$, 一开始, 这个集合里有 $n$ 个 $\text{Fib}_1$ ( 也可以看做 $\text{Fib}_0$ ), 然后像消消乐一样, 若 $S$ 当前存在一个 $\text{Fib}_k$ 与一个 $\text{Fib}_{k + 1}$, 就将它们拿掉, 放入一个 $\text{Fib}_{k + 2}$, 其数学原理就是 $\text{Fib}_{k + 2} = \text{Fib}_k + \text{Fib}_{k + 1}$

显然, 我们最后会得到一个不再变化的集合, 里面不存在相邻的 $\text{Fib}$, 否则就会继续消



所以回到原来的问题, 我们将 $n$ 分解一下 ( 按照上面的式子分解方式, 那么 $\text{Fib}_{k_1}$ 是最小的, 然后后面依次变大 ), 设先手第一次取了 $a$ 个石子

那么 $a$ 应当等于 $\text{Fib}_{k_1}$, 这样的话, 就把行动权交给了后手, 那么由于上面的引理, $2\cdot \text{Fib}_{k_1} < \text{Fib}_{k_2}$, 说明无论怎样, 后手都不能一次性地将下一个 $\text{Fib}$ 取完, 然后就跟我们之前的证明很像了, 先手一直能保证他总是最后取完任意一个 $\text{Fib}$ 堆

所以, 一个非斐波那契数, 由于其总能分解成至少两个 $\text{Fib}$, 所以总是 **先手必胜**



综上, 斐波那契博弈的规律是

1. $n$ 为斐波那契数, 先手必败
2. $n$ 不为斐波那契数, 先手必胜



#### $\S $ 参考

* [csdn 博客](https://blog.csdn.net/dgq8211/article/details/7602807)

